#!/bin/bash

# This script is used to automatically extract a dump from a local running instance of cve_search, 7zip it, and cut the
# 7z archive into 50M pieces

mongodump -d cvedb --gzip

7z a -t7z -m0=lzma -mx=9 -mfb=64 -md=32m -ms=on db_dump.7z ./dump

split -b 50M db_dump.7z "db_dump_part"

rm -rf ./dump
rm -rf ./db_dump.7z
