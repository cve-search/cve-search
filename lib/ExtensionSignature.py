from enum import Enum
from typing import List


class ExtensionSignature(Enum):
    ZIP = "504B0304"
    GZip = "1F8B08"

    # https://stackoverflow.com/questions/33533148/how-do-i-specify-that-the-return-type-of-a-method-is-the-same-as-the-class-itsel
    @staticmethod
    def values() -> List['ExtensionSignature']:
        return [v for v in ExtensionSignature]

    @staticmethod
    def maxSize() -> int:
        """
        Returns the maximum size in bytes of the available signatures.
        :return: The size in bytes of the longest signature.
        """

        return max(map(lambda e: int(len(bin(int(e.value, 16))) / 8), ExtensionSignature.values()))

    @staticmethod
    def fromSignature(signature: str) -> 'ExtensionSignature':
        signature = signature.upper()

        for e in ExtensionSignature.values():
            if signature.startswith(e.value):
                return e

        return None
